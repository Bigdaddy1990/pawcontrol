name: Ruff baseline (web only)

on:
  workflow_dispatch:

permissions:
  contents: write
  pull-requests: write

jobs:
  baseline:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - uses: actions/setup-python@v5
        with:
          python-version: "3.13"
      - name: Install ruff
        run: python -m pip install --upgrade pip && pip install ruff
      - name: Ruff format + fixes + add-noqa + cleanup
        run: |
          ruff --version
          ruff format .
          # sichere + unsichere Fixes f√ºr den Einmal-Rutsch
          ruff check . --fix --unsafe-fixes || true
          # alle verbleibenden Findings baselinieren
          ruff check . --add-noqa || true
          # unbenutzte noqa wieder entfernen
          ruff check . --extend-select RUF100 --fix || true
      - name: Create PR with changes
        uses: peter-evans/create-pull-request@v7
        with:
          branch: chore/ruff-baseline
          title: "chore: ruff baseline (format+fix+noqa)"
          commit-message: "chore: ruff baseline (format+fix+noqa)"
          body: "Automated ruff baseline via GitHub Actions."
